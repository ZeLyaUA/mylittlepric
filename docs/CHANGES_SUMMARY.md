# Summary of Changes - Logging & WebSocket Improvements

## –û–±–∑–æ—Ä

–î–æ–±–∞–≤–ª–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∞–π–º–∞—É—Ç–æ–º WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

## 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ SERP API ‚úÖ

### –ò–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `fmt.Printf` –Ω–∞ `slog` —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (`session_id`, `user_id`) –≤–æ –≤—Å–µ –ª–æ–≥–∏
- ‚úÖ –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —ç—Ç–∞–ø—ã SERP –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### –§–∞–π–ª—ã
- `backend/internal/services/serp.go` - –ø–æ–ª–Ω–æ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- `backend/internal/handlers/processor.go` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –ª–æ–≥–∏
- `backend/internal/handlers/product.go` - –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `backend/internal/handlers/websocket.go` - –ø–µ—Ä–µ–¥–∞—á–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `backend/internal/handlers/metrics.go` - —É–¥–∞–ª–µ–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –ª–æ–≥–∏

### –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –¥–ª—è SERP

**–ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞—Ü–∏–∏ –ø–æ–∏—Å–∫–∞:**
```json
{
  "msg": "üîç SERP search initiated",
  "session_id": "abc-123",
  "user_id": "user-456",
  "query": "iphone 15 pro",
  "search_type": "exact",
  "country": "US",
  "language": "en",
  "min_price": 500,
  "max_price": 1500
}
```

**–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:**
```json
{
  "msg": "‚úÖ SERP search completed successfully",
  "session_id": "abc-123",
  "user_id": "user-456",
  "product_count": 10,
  "relevance_score": 0.92,
  "top_products": ["iPhone 15 Pro 256GB", "iPhone 15 Pro Max", "..."]
}
```

**–ü—Ä–∏ –æ—à–∏–±–∫–µ:**
```json
{
  "msg": "‚ùå SERP API error",
  "session_id": "abc-123",
  "error": "quota exceeded",
  "duration_seconds": 1.23,
  "attempt": 1,
  "max_attempts": 4,
  "key_index": 2
}
```

## 2. WebSocket Keep-Alive (Heartbeat) ‚úÖ

### –ü—Ä–æ–±–ª–µ–º–∞
WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á–∞–ª–æ—Å—å –ø–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (2-3 –º–∏–Ω—É—Ç—ã), —Ç—Ä–µ–±—É—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### –†–µ—à–µ–Ω–∏–µ

#### Frontend (React)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π ping –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- ‚úÖ Ping –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ heartbeat –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–§–∞–π–ª:** `frontend/src/features/chat/hooks/use-chat.ts`

```typescript
// Send ping every 30 seconds to keep connection alive
useEffect(() => {
  if (!isConnected) return;

  console.log("üíì Starting heartbeat ping");

  const pingInterval = setInterval(() => {
    if (readyState === ReadyState.OPEN) {
      console.log("üíì Sending ping");
      sendJsonMessage({ type: 'ping' });
    }
  }, 30000); // 30 seconds

  return () => {
    console.log("üíî Stopping heartbeat ping");
    clearInterval(pingInterval);
  };
}, [isConnected, readyState, sendJsonMessage]);
```

#### Backend (Go)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω read deadline (60 —Å–µ–∫—É–Ω–¥)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π reset deadline –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ pong –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ç–∞–π–º–µ—Ä–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ WebSocket —Ç–∞–π–º–∞—É—Ç–æ–≤

**–§–∞–π–ª:** `backend/internal/handlers/websocket.go`

```go
// Set initial read deadline (60 seconds - client should ping within 30s)
c.SetReadDeadline(time.Now().Add(60 * time.Second))

// Set pong handler to reset read deadline
c.SetPongHandler(func(string) error {
    c.SetReadDeadline(time.Now().Add(60 * time.Second))
    return nil
})

// Reset read deadline on any message (not just pong)
c.SetReadDeadline(time.Now().Add(60 * time.Second))
```

**–§–∞–π–ª:** `backend/internal/app/routes.go`

```go
app.Get("/ws", websocket.New(func(conn *websocket.Conn) {
    wsHandler.HandleWebSocket(conn)
}, websocket.Config{
    ReadBufferSize:  1024,
    WriteBufferSize: 1024,
}))
```

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Frontend** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ping –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
2. **Backend** –æ–∂–∏–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥
3. –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ ping (–∏–ª–∏ –ª—é–±–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è) backend —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ç–∞–π–º–µ—Ä
4. Backend –æ—Ç–≤–µ—á–∞–µ—Ç pong –Ω–∞ ping
5. –ï—Å–ª–∏ 60 —Å–µ–∫—É–Ω–¥ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –ª–æ–≥–æ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –¥–∞–∂–µ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## 3. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **docs/LOGGING.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (EN)
- **docs/LOGGING_RU.md** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (RU)
- **grafana/loki-queries.md** - –ì–æ—Ç–æ–≤—ã–µ query –ø—Ä–∏–º–µ—Ä—ã (50+)
- **grafana/loki-monitoring-queries.md** - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑ session_id (20+ –∑–∞–ø—Ä–æ—Å–æ–≤)

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **CLAUDE.md** - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è –æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ
- **docs/CHANGES_SUMMARY.md** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

#### –° –∏–∑–≤–µ—Å—Ç–Ω—ã–º session_id
```logql
{compose_service="mylittleprice-backend"}
  | json
  | session_id = "YOUR_SESSION_ID"
  |~ "SERP"
```

#### –ë–µ–∑ session_id - –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º
```logql
# –í—Å–µ –æ—à–∏–±–∫–∏ —Å session_id
{compose_service="mylittleprice-backend"}
  | json
  | level = "ERROR"
  | line_format "{{.session_id}} | {{.msg}}: {{.error}}"
```

```logql
# –ù–µ—É–¥–∞—á–Ω—ã–µ SERP –∑–∞–ø—Ä–æ—Å—ã
{compose_service="mylittleprice-backend"}
  |~ "SERP API error|No relevant products"
  | json
  | line_format "Session: {{.session_id}} | Query: '{{.query}}'"
```

```logql
# –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
{compose_service="mylittleprice-backend"}
  | json
  | duration_seconds > 3
  | line_format "{{.session_id}} | {{.duration_seconds}}s"
```

## 4. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ **–ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞** –≤—Å–µ—Ö SERP –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è** –ª–æ–≥–æ–≤ –ø–æ session_id
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (duration, retry, key_index)
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º** –±–µ–∑ –∑–Ω–∞–Ω–∏—è session_id –∑–∞—Ä–∞–Ω–µ–µ

### –î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** —á–µ—Ä–µ–∑ Grafana Loki
- ‚úÖ **–ì–æ—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- ‚úÖ **–¢–æ–ø –æ—à–∏–±–æ–∫** –∏ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ **–ê–ª–µ—Ä—Ç—ã** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - –Ω–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏–π
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ** –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Å–µ—Ç—å—é
- ‚úÖ **–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** —Å—Ç—Ä–∞–Ω–∏—Ü—ã

## 5. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Grafana** ‚Üí http://localhost:3001 ‚Üí Explore ‚Üí Loki

2. **–ù–∞–π–¥–∏—Ç–µ –Ω–µ–¥–∞–≤–Ω–∏–µ –æ—à–∏–±–∫–∏:**
```logql
{compose_service="mylittleprice-backend"}
  | json
  | level = "ERROR"
  | __timestamp__ > now() - 1h
```

3. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ session_id** –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

4. **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**
```logql
{compose_service="mylittleprice-backend"}
  | json
  | session_id = "COPIED_SESSION_ID"
```

### –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã

1. **–í—Å–µ SERP –æ—à–∏–±–∫–∏:**
```logql
{compose_service="mylittleprice-backend"}
  |~ "SERP API error"
  | json
```

2. **Quota –æ—à–∏–±–∫–∏:**
```logql
{compose_service="mylittleprice-backend"}
  |= "Quota error detected"
  | json
```

3. **WebSocket –ø—Ä–æ–±–ª–µ–º—ã:**
```logql
{compose_service="mylittleprice-backend"}
  |~ "WebSocket (error|timeout)"
```

## 6. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞** –≤ Loki - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- **Batching** - –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞–∫–µ—Ç–∞–º–∏

### WebSocket
- **–ù–∏–∑–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫** - ping —Ä–∞–∑ –≤ 30 —Å–µ–∫—É–Ω–¥ (~20 bytes)
- **–ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π** - —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- **Graceful timeout** - 60 —Å–µ–∫—É–Ω–¥ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è

## 7. –ú–∏–≥—Ä–∞—Ü–∏—è

### –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —É—Å—Ç–∞–Ω–æ–≤–æ–∫

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ backend** - –Ω–æ–≤—ã–π –∫–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
2. **–û–±–Ω–æ–≤–∏—Ç–µ frontend** - `npm run build` –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Grafana** - –ª–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –≤ Loki
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –ù–µ—Ç breaking changes
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø–æ–ª–Ω–∞—è
- ‚úÖ –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ WebSocket –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

## 8. –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è production

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã** –≤ Grafana:
   - –ú–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ (>10/min)
   - Quota –æ—à–∏–±–∫–∏ (>5/5min)
   - –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (p95 >5s)

2. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã:**
   - Error Rate Overview
   - SERP Performance
   - WebSocket Health
   - User Activity

3. **Retention policy:**
   - –•—Ä–∞–Ω–∏—Ç–µ –ª–æ–≥–∏ 7 –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –ò–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

4. **Log sampling** (–µ—Å–ª–∏ –±–æ–ª—å—à–æ–π —Ç—Ä–∞—Ñ–∏–∫):
   - –°–Ω–∏–∑—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –¥–æ WARN –≤ production
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ sampling –¥–ª—è INFO –ª–æ–≥–æ–≤

## 9. Troubleshooting

### –õ–æ–≥–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Loki
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Promtail: `docker-compose logs promtail`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ LOG_FORMAT=json –≤ .env
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ docker-compose.monitoring.yml

### WebSocket –≤—Å–µ –µ—â–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ "üíì Sending ping"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ backend –ª–æ–≥–∏ –Ω–∞ "pong"
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç reverse proxy —Å –∫–æ—Ä–æ—Ç–∫–∏–º timeout

### session_id –Ω–µ –≤ –ª–æ–≥–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ ctx –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ session —Å–æ–∑–¥–∞–Ω–∞ –ø–µ—Ä–µ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ utils.WithSessionID(ctx, sessionID)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ —Å–º–æ—Ç—Ä–∏—Ç–µ:
- **docs/LOGGING.md** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **docs/LOGGING_RU.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- **grafana/loki-monitoring-queries.md** - –≥–æ—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
